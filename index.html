<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR Re:Start Анкета</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); padding: 40px; }
        h1 { color: #333; margin-bottom: 10px; font-size: 28px; }
        .subtitle { color: #666; margin-bottom: 30px; }
        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: 500; color: #333; margin-bottom: 8px; font-size: 14px; }
        input[type="text"], input[type="number"], select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; }
        input[type="text"]:focus, input[type="number"]:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
        .checkbox-group, .radio-group { display: flex; flex-direction: column; gap: 10px; }
        input[type="checkbox"], input[type="radio"] { margin-right: 8px; cursor: pointer; }
        .radio-group label, .checkbox-group label { display: flex; align-items: center; cursor: pointer; margin: 0; }
        .section { border-bottom: 1px solid #eee; padding-bottom: 30px; margin-bottom: 30px; }
        .section:last-child { border-bottom: none; }
        h2 { color: #667eea; font-size: 18px; margin-bottom: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; }
        button { background: #667eea; color: white; border: none; padding: 15px 30px; font-size: 16px; font-weight: 600; border-radius: 6px; cursor: pointer; width: 100%; margin-top: 20px; transition: all 0.3s; }
        button:hover { background: #764ba2; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4); }
        button:disabled { background: #ccc; cursor: not-allowed; transform: none; }
        .success { background: #d4edda; border: 1px solid #28a745; color: #155724; padding: 15px; border-radius: 6px; margin-bottom: 20px; display: none; }
        .success.show { display: block; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; padding: 15px; border-radius: 6px; margin-bottom: 20px; display: none; }
        .error.show { display: block; }
        .spinner { display: none; }
        .spinner.show { display: inline-block; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Анкета HR Re:Start</h1>
        <p class="subtitle">Заповнення займе близько 7 хвилин</p>
        
        <div id="success" class="success"></div>
        <div id="error" class="error"></div>

        <form id="form">
            <!-- І. Загальна інформація -->
            <div class="section">
                <h2>І. Загальна інформація</h2>
                
                <div class="form-group">
                    <label>ПІБ *</label>
                    <input type="text" name="name" required>
                </div>

                <div class="grid">
                    <div class="form-group">
                        <label>Вік</label>
                        <input type="number" name="age">
                    </div>
                    <div class="form-group">
                        <label>Зріст (см)</label>
                        <input type="number" name="height">
                    </div>
                    <div class="form-group">
                        <label>Вага (кг)</label>
                        <input type="number" name="weight">
                    </div>
                </div>

                <div class="form-group">
                    <label>Обхват грудей (см)</label>
                    <input type="number" name="chest">
                </div>
                <div class="form-group">
                    <label>Обхват під грудьми (см)</label>
                    <input type="number" name="chestUnder">
                </div>
                <div class="form-group">
                    <label>Обхват талії (см)</label>
                    <input type="number" name="waist">
                </div>
                <div class="form-group">
                    <label>Обхват стегон (см)</label>
                    <input type="number" name="hips">
                </div>
                <div class="form-group">
                    <label>Обхват руки (см)</label>
                    <input type="number" name="arm">
                </div>

                <div class="form-group">
                    <label>Чи є ви вагітною або годуєте грудьми?</label>
                    <div class="radio-group">
                        <label><input type="radio" name="pregnant" value="Так"> Так</label>
                        <label><input type="radio" name="pregnant" value="Ні"> Ні</label>
                        <label><input type="radio" name="pregnant" value="Не стосується"> Не стосується</label>
                    </div>
                </div>
            </div>

            <!-- ІІ. Стан здоров'я -->
            <div class="section">
                <h2>ІІ. Стан здоров'я та анамнез</h2>
                
                <div class="form-group">
                    <label>Хірургічні втручання за 6 місяців?</label>
                    <div class="radio-group">
                        <label><input type="radio" name="surgery" value="Так"> Так</label>
                        <label><input type="radio" name="surgery" value="Ні"> Ні</label>
                    </div>
                </div>
                <div id="surgeryDescDiv" class="form-group" style="display:none;">
                    <label>Опис та дата:</label>
                    <input type="text" name="surgeryDesc">
                </div>

                <div class="form-group">
                    <label>Апендектомія?</label>
                    <div class="radio-group">
                        <label><input type="radio" name="appendectomy" value="Так"> Так</label>
                        <label><input type="radio" name="appendectomy" value="Ні"> Ні</label>
                    </div>
                </div>
                <div id="appendectomyAgeDiv" class="form-group" style="display:none;">
                    <label>У якому віці?</label>
                    <input type="number" name="appendectomyAge">
                </div>

                <div class="form-group">
                    <label>Харчова алергія/непереносимість?</label>
                    <div class="radio-group">
                        <label><input type="radio" name="hasAllergy" value="Так"> Так</label>
                        <label><input type="radio" name="hasAllergy" value="Ні"> Ні</label>
                    </div>
                </div>
                <div id="foodAllergyDiv" class="form-group" style="display:none;">
                    <label>Опишіть:</label>
                    <input type="text" name="foodAllergy">
                </div>
            </div>

            <!-- V. Підтвердження -->
            <div class="section">
                <h2>V. Підтвердження та згода</h2>
                
                <div class="checkbox-group">
                    <label><input type="checkbox" name="confirmed" required> Надав(ла) достовірну інформацію</label>
                    <label><input type="checkbox" name="understandMedical" required> Розумію, що програма не замінює медичне лікування</label>
                    <label><input type="checkbox" name="agreeData" required> Погоджуюсь на використання знеособлених даних</label>
                </div>
            </div>

            <button type="submit" id="submitBtn">Відправити анкету</button>
        </form>
    </div>

    <script>
        const form = document.getElementById('form');
        const submitBtn = document.getElementById('submitBtn');
        const successMsg = document.getElementById('success');
        const errorMsg = document.getElementById('error');

        // Show/hide conditional fields
        document.querySelector('input[name="surgery"]').addEventListener('change', (e) => {
            document.getElementById('surgeryDescDiv').style.display = e.target.value === 'Так' ? 'block' : 'none';
        });

        document.querySelector('input[name="appendectomy"]').addEventListener('change', (e) => {
            document.getElementById('appendectomyAgeDiv').style.display = e.target.value === 'Так' ? 'block' : 'none';
        });

        document.querySelector('input[name="hasAllergy"]').addEventListener('change', (e) => {
            document.getElementById('foodAllergyDiv').style.display = e.target.value === 'Так' ? 'block' : 'none';
        });

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            successMsg.classList.remove('show');
            errorMsg.classList.remove('show');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Відправлення...';

            try {
                const formData = new FormData(form);
                const data = {
                    timestamp: new Date().toISOString(),
                    name: formData.get('name'),
                    age: formData.get('age'),
                    height: formData.get('height'),
                    weight: formData.get('weight'),
                    chest: formData.get('chest'),
                    chestUnder: formData.get('chestUnder'),
                    waist: formData.get('waist'),
                    hips: formData.get('hips'),
                    arm: formData.get('arm'),
                    pregnant: formData.get('pregnant'),
                    surgery: formData.get('surgery'),
                    surgeryDesc: formData.get('surgeryDesc'),
                    appendectomy: formData.get('appendectomy'),
                    appendectomyAge: formData.get('appendectomyAge'),
                    hasAllergy: formData.get('hasAllergy'),
                    foodAllergy: formData.get('foodAllergy'),
                };

                const response = await fetch('https://script.google.com/macros/s/AKfycbwwfsARcdrfVuOC5ZjOGegv9APJmlUqaulKGeG0_6yIMSfaJBosiAvGX9sFtaIe_rY2/exec', {
                    method: 'POST',
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    successMsg.textContent = '✓ Дякуємо за участь у програмі HR Re:Start!\n\nВаша анкета успішно збережена.';
                    successMsg.classList.add('show');
                    form.reset();
                } else {
                    throw new Error('Помилка при збереженні');
                }
            } catch (err) {
                errorMsg.textContent = 'Помилка при відправці даних. Спробуйте ще раз.';
                errorMsg.classList.add('show');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Відправити анкету';
            }
        });
    </script>
</body>
</html>
